Лутц, стр 826.

## Контрольные вопросы
1. Какие два метода перегрузки операторов можно использовать для поддержки итераций в классах?
2. Какие два метода перегрузки операторов можно использовать для вывода и в каких случаях?
3. Как реализовать в классе операции над срезами?
4. Как реализовать в классе операцию приращения значения самого объекта?
5. Когда следует использовать методы перегрузки операторов?

## Ответы

1. Классы могут обеспечить поддержку итераций, определив (или унаследовав) метод \_\_getitem\_\_ или \_\_iter\_\_. Во всех итерационных контекстах интерпретатор Python сначала пытается использовать метод \_\_iter\_\_ (который возвращает объект, поддерживающий итерационный протокол в виде метода \_\_next\_\_): если метод \_\_iter\_\_ не будет найден в результате поиска по дереву наследования, интерпретатор возвращается к использованию метода извлечения элемента по его индексу \_\_getitem\_\_ (который вызывается многократно и при каждом вызове получает постоянно увеличивающиеся значения индексов).

2. Вывод объекта реализуют методы \_\_str\_\_ и \_\_repr\_\_. Первый из них вызывается встроенными функциями print и str; последний также вызывается функциями print и str, если в классе отсутствует метод \_\_str\_\_, и всегда - встроенной функцией repr, функцией автоматического вывода интерактив-
ной оболочки и при выводе вложенных экземпляров. То есть метод \_\_repr\_\_ используется везде, за исключением функций print и str, если определен метод \_\_str\_\_. Метод \_\_str\_\_ обычно используется для вывода объектов в удобочитаемом представлении; метод \_\_repr\_\_ выводит дополнительные
подробности об объекте или представляет объект в виде программного кода.

3. Операцию извлечения среза можно перехватить с помощью метода \_\_getitem\_\_:
в этом случае ему передается не простой числовой индекс, а объект
среза. В Python 2.6 точно так же можно использовать метод \_\_getslice\_\_
(в версии 3.0 он уже не используется).

4. Операция приращения пытается сначала вызвать метод \_\_iadd\_\_, а затем
метод \_\_add\_\_ с последующим присваиванием. Тот же самый прием может
применяться для всех двухместных операторов. Кроме того, правостороннее сложение можно реализовать с помощью метода \_\_radd\_\_.

5. Когда класс естественным образом соответствует встроенным типам или
должен подражать их поведению. Например, классы коллекций могут имитировать поведение последовательностей или отображений. Как правило,
не следует реализовать методы перегрузки операторов, если они не являются естественными для ваших объектов, – лучше использовать методы
с обычными именами.
